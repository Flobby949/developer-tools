# 主题与样式系统

<cite>
**本文档引用的文件**
- [base.css](file://src/assets/base.css)
- [main.css](file://src/assets/main.css)
- [app.ts](file://src/stores/app.ts)
- [AppLayout.vue](file://src/components/AppLayout.vue)
- [main.ts](file://src/main.ts)
</cite>

## 目录
1. [主题切换机制](#主题切换机制)
2. [CSS架构设计](#css架构设计)
3. [响应式设计实现](#响应式设计实现)
4. [自定义新主题扩展指南](#自定义新主题扩展指南)

## 主题切换机制

程序工具的主题切换机制基于Vue 3和Pinia状态管理实现，通过`appStore`中的`themePreference`状态来控制主题偏好。系统支持三种主题模式：跟随系统（auto）、浅色模式（light）和深色模式（dark）。当用户点击主题切换按钮时，会触发`toggleTheme`方法，在三种模式之间循环切换。

主题状态的变化通过`setThemePreference`方法更新，并调用`applyThemeClasses`函数将相应的CSS类添加到根元素（html标签）上。具体来说：
- 当选择"浅色模式"时，向根元素添加`theme-light`类
- 当选择"深色模式"时，向根元素添加`theme-dark`和`dark`类
- 当选择"跟随系统"时，不添加特定类，而是依赖CSS媒体查询`@media (prefers-color-scheme: dark)`来自动应用深色样式

系统还实现了主题偏好的持久化存储，使用`localStorage`保存用户的主题选择（键名为`developer-tools-theme-preference`），确保页面刷新后仍能保持用户的选择。同时，通过监听`window.matchMedia('(prefers-color-scheme: dark)')`的变化，可以实时响应系统主题的改变。

此外，系统还会根据当前主题动态更新页面的`theme-color`元标签，影响浏览器地址栏等UI元素的颜色，提供更一致的视觉体验。

**Section sources**
- [app.ts](file://src/stores/app.ts#L50-L99)
- [app.ts](file://src/stores/app.ts#L210-L252)
- [AppLayout.vue](file://src/components/AppLayout.vue#L10-L25)

## CSS架构设计

本项目的CSS架构采用模块化设计，主要由`base.css`和`main.css`两个核心样式文件组成。`base.css`负责定义全局的CSS自定义属性（CSS Variables）和基础样式，而`main.css`则导入`base.css`并在此基础上构建具体的组件样式。

在`base.css`中，首先定义了两套基础颜色变量：一套以`--vt-c-`为前缀的原始颜色值，另一套以`--color-`为前缀的语义化颜色变量。这种设计分离了具体颜色值和其语义含义，使得主题定制更加灵活。例如，`--color-background`变量可以根据主题设置为白色或黑色，而组件样式只需引用这个语义化变量，无需关心具体的颜色值。

主题相关的CSS变量主要通过以下三种方式实现：
1. **默认主题**：`:root`选择器中定义的变量用于浅色模式
2. **媒体查询**：`@media (prefers-color-scheme: dark)`用于检测系统级的深色模式偏好
3. **CSS类**：`.theme-light`、`.theme-dark`和`.dark`类提供了手动覆盖主题的能力，具有更高的优先级

`main.css`文件通过`@import './base.css'`引入基础样式，并利用这些CSS变量来定义各种UI组件的样式，如按钮（`.btn`）、输入框（`.input`）、卡片（`.card`）等。这种方式确保了整个应用的视觉一致性，同时也便于维护和扩展。

**Section sources**
- [base.css](file://src/assets/base.css#L0-L196)
- [main.css](file://src/assets/main.css#L1-L326)

## 响应式设计实现

本项目采用了移动优先的响应式设计策略，通过断点设置、弹性布局（Flexbox）和移动端适配策略来确保在不同设备上的良好用户体验。

### 断点设置
项目主要使用了两个关键断点：
- `768px`：用于区分平板/手机与桌面设备
- `1024px`：用于优化大屏幕显示

在`main.css`和组件样式文件中，通过`@media (max-width: 768px)`查询来定义移动端的特殊样式。例如，在小屏幕上，侧边栏会变为固定定位的抽屉式导航，通过滑动或点击菜单按钮来展开。

### 弹性布局（Flexbox）使用
项目广泛使用Flexbox布局来创建灵活的界面结构。在`AppLayout.vue`中，主容器使用`display: flex`创建了一个侧边栏+主内容区域的布局。通过`flex-direction: column`和`flex: 1`等属性，确保了内容区域能够充分利用剩余空间。

同时，项目定义了一系列实用的布局类，如`.flex`、`.flex-col`、`.items-center`、`.justify-between`等，这些类可以直接在模板中使用，简化了布局代码。例如，`.justify-between`实现了两端对齐，常用于标题区域的布局。

### 移动端适配策略
针对移动端进行了多项优化：
1. **触摸友好的交互元素**：按钮和链接有足够的点击区域
2. **可滚动的内容区域**：主要内容区域设置了`overflow-y: auto`，确保在小屏幕上可以滚动查看所有内容
3. **字体大小调整**：在小屏幕上适当减小字体大小，以适应有限的显示空间
4. **间距优化**：使用相对单位（如rem）和CSS变量定义间距，确保在不同屏幕尺寸下都能保持良好的视觉层次

这些响应式设计策略共同作用，确保了应用在各种设备上都能提供优秀的用户体验。

**Section sources**
- [main.css](file://src/assets/main.css#L211-L324)
- [AppLayout.vue](file://src/components/AppLayout.vue#L400-L447)
- [AppLayout.vue](file://src/components/AppLayout.vue#L500-L544)

## 自定义新主题扩展指南

要为本项目创建新的自定义主题，开发者可以遵循以下步骤进行扩展，同时确保不破坏现有的样式结构。

### 新增颜色变量
1. 在`base.css`的`:root`选择器中添加新的颜色变量，建议使用`--vt-c-`前缀定义具体的颜色值
2. 在语义化颜色变量部分添加对应的映射，例如：
```css
/* 在 :root 中添加 */
--vt-c-custom-primary: #ff6b6b;
--vt-c-custom-secondary: #4ecdc4;

/* 在语义化变量中添加 */
--color-primary: var(--vt-c-custom-primary);
--color-secondary: var(--vt-c-custom-secondary);
```

### 调整字体大小层级
项目目前使用固定的14px基础字体大小，可以通过以下方式调整：
1. 修改`body`选择器中的`font-size`属性
2. 创建新的字体大小变量，如`--font-size-sm`、`--font-size-lg`等
3. 在需要的地方使用这些变量替代硬编码的字体大小

### 修改组件间距
项目已经通过CSS变量定义了一套完整的间距系统（`--spacing-xs`到`--spacing-xl`），修改这些变量的值即可全局调整组件间距：
```css
/* 在 base.css 中调整间距变量 */
--spacing-xs: 0.2rem;
--spacing-sm: 0.4rem;
--spacing: 0.8rem;
--spacing-md: 1.2rem;
--spacing-lg: 1.6rem;
--spacing-xl: 2.4rem;
```

### 创建新主题类
要创建全新的主题（而非简单的明暗切换），可以仿照现有主题类的方式：
```css
.theme-custom {
  --color-background: #f8f9fa;
  --color-background-soft: #e9ecef;
  --color-background-mute: #dee2e6;
  --color-text: #212529;
  --color-primary: #6f42c1;
  /* 其他变量... */
}
```

然后在JavaScript中相应地更新`applyThemeClasses`函数，支持新的主题类。通过这种方式，开发者可以在保持现有架构完整性的同时，轻松实现视觉定制需求。

**Section sources**
- [base.css](file://src/assets/base.css#L43-L90)
- [base.css](file://src/assets/base.css#L131-L196)
- [app.ts](file://src/stores/app.ts#L50-L99)